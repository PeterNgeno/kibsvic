<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create Your Page</title>
  <link rel="stylesheet" href="style.css">
  <style>
    img.preview {
      margin-top: 10px;
      max-width: 100%;
      max-height: 300px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h2>Customize Your Page</h2>

  <label>Title: <input type="text" id="titleInput"></label><br>
  <label>Description:<br>
    <textarea id="descInput" rows="4" cols="50"></textarea>
  </label><br>

  <label>Choose Font:
    <select id="fontSelect">
      <option value="Arial">Arial</option>
      <option value="Georgia">Georgia</option>
      <option value="Courier New">Courier New</option>
    </select>
  </label><br>

  <label>Text Color: <input type="color" id="textColorInput"></label><br>
  <label>Background Color: <input type="color" id="bgColorInput"></label><br>

  <label>Animation:
    <select id="animationSelect">
      <option value="none">None</option>
      <option value="fadeIn">Fade In</option>
      <option value="slideIn">Slide In</option>
    </select>
  </label><br><br>

  <label>Paste Image Link: <input type="url" id="imgLinkInput" placeholder="e.g. https://drive.google.com/..."></label><br>
  <label>Or Upload Image:
    <input type="file" accept="image/*" id="imageUploader" onchange="previewImage(event)">
  </label><br>
  <img id="imagePreview" class="preview" style="display: none;"><br>

  <label>Paste Video/YouTube Link:
    <input type="url" id="videoLinkInput" placeholder="e.g. https://youtu.be/...">
  </label><br><br>

  <button onclick="savePage()">Save Page</button>

  <script>
    function previewImage(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(e) {
        const dataUrl = e.target.result;
        document.getElementById("imagePreview").src = dataUrl;
        document.getElementById("imagePreview").style.display = "block";
        document.getElementById("imgLinkInput").value = dataUrl;
      };
      reader.readAsDataURL(file);
    }

    async function savePage() {
      const title = document.getElementById("titleInput").value;
      const desc = document.getElementById("descInput").value;
      const font = document.getElementById("fontSelect").value;
      const color = document.getElementById("textColorInput").value;
      const bgColor = document.getElementById("bgColorInput").value;
      const anim = document.getElementById("animationSelect").value;
      const image = document.getElementById("imgLinkInput").value;
      const video = document.getElementById("videoLinkInput").value;

      const timestamp = new Date().toLocaleString("en-GB", { timeZone: "Africa/Nairobi" });

      const data = {
        values: [[timestamp, title, desc, font, color, bgColor, anim, image, video]]
      };

      try {
        const response = await fetch(
          "https://sheets.googleapis.com/v4/spreadsheets/1wxKcMGMrxSIsiqOWaqKlHAwKj_qaNP3HxSBpu67hKHA/values/pages:append?valueInputOption=USER_ENTERED&key=AIzaSyDtgJrmygEsN6xkvw5UHSwjizgH9Ii_eSc",
          {
            method: "POST",
            body: JSON.stringify(data),
            headers: {
              "Content-Type": "application/json"
            }
          }
        );

        if (response.ok) {
          alert("Page saved successfully!");
          window.location.reload();
        } else {
          const error = await response.json();
          console.error("Save error:", error);
          alert("Failed to save. Please check your sheet permissions or API key.");
        }
      } catch (error) {
        alert("Error occurred while saving. Check console.");
        console.error(error);
      }
    }
  </script>
</body>
</html>
