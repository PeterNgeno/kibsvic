<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create Your Page</title>
  <link rel="stylesheet" href="style.css">
  <style>
    img.preview {
      margin-top: 10px;
      max-width: 100%;
      max-height: 300px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h2>Customize Your Page</h2>

  <label>Title: <input type="text" id="titleInput"></label><br>
  <label>Description:<br>
    <textarea id="descInput" rows="4" cols="50"></textarea>
  </label><br>

  <label>Choose Font:
    <select id="fontSelect">
      <option value="Arial">Arial</option>
      <option value="Georgia">Georgia</option>
      <option value="Courier New">Courier New</option>
    </select>
  </label><br>

  <label>Text Color: <input type="color" id="textColorInput"></label><br>
  <label>Background Color: <input type="color" id="bgColorInput"></label><br>

  <label>Animation:
    <select id="animationSelect">
      <option value="none">None</option>
      <option value="fadeIn">Fade In</option>
      <option value="slideIn">Slide In</option>
    </select>
  </label><br><br>

  <label>Paste Image Link: <input type="url" id="imgLinkInput" placeholder="https://drive.google.com/..."></label><br>
  <label>Or Upload Image: <input type="file" accept="image/*" id="imageUploader" onchange="previewImage(event)"></label><br>
  <img id="imagePreview" class="preview" style="display:none;"><br>

  <label>Paste Video Link: <input type="url" id="videoLinkInput" placeholder="https://youtu.be/..."></label><br><br>

  <button onclick="savePage()">Save Page</button>

<script>
  function previewImage(event) {
    const f = event.target.files[0];
    if (!f) return;
    const r = new FileReader();
    r.onload = e => {
      document.getElementById("imagePreview").src = e.target.result;
      document.getElementById("imagePreview").style.display = "block";
      document.getElementById("imgLinkInput").value = e.target.result;
    };
    r.readAsDataURL(f);
  }

  async function savePage() {
    const title = document.getElementById("titleInput").value.trim();
    if (!title) { alert("Please enter a title"); return; }
    const desc = document.getElementById("descInput").value || "";
    const font = document.getElementById("fontSelect").value;
    const color = document.getElementById("textColorInput").value;
    const bgColor = document.getElementById("bgColorInput").value;
    const anim = document.getElementById("animationSelect").value;
    const image = document.getElementById("imgLinkInput").value || "";
    const video = document.getElementById("videoLinkInput").value || "";
    const timestamp = new Date().toLocaleString("en-GB", { timeZone:"Africa/Nairobi" });

    const data = {
      values: [[timestamp, title, desc, font, color, bgColor, anim, image, video]]
    };

    try {
      const response = await fetch(
        "https://script.google.com/macros/s/AKfycbzHtDFVJ-z_PQe_HW42ajylGGsFFhDrF23bd9Q8BdOKrQCieA4H9_RGaDRDKrzpO_pt/exec",
        {
          method: "POST",
          body: JSON.stringify(data),
          headers: {
            "Content-Type": "application/json"
          }
        }
      );

      if (response.ok) {
        alert("Page saved successfully!");
        window.location.reload();
      } else {
        const err = await response.text();
        alert("Failed to save:\n" + err);
        console.error("Response error:", err);
      }
    } catch (error) {
      alert("Unexpected error occurred. Check console.");
      console.error("Unexpected error:", error);
    }
  }
</script>
</body>
</html>
