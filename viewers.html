<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>All Pages</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .page-box {
      border: 1px solid #ccc;
      margin-bottom: 30px;
      padding: 15px;
      border-radius: 10px;
      background: white;
    }
  </style>
</head>
<body>
  <h2>All Pages</h2>
  <div id="allPages"></div>

  <script>
    const sheetID = "1wzVfCTFpOSGRSHVWbtu9EybizYcO5zBNATiDK2SCu_Q";
    const sheetName = "pages";
    const apiKey = "AIzaSyDtgJrmygEsN6xkvw5UHSwjizgH9Ii_eSc";

    async function loadPages() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${sheetName}?key=${apiKey}`;
      const res = await fetch(url);
      const data = await res.json();
      const rows = data.values;
      const container = document.getElementById("allPages");

      for (let i = 1; i < rows.length; i++) {
        const [timestamp, title, desc, font, color, bgColor, anim, image, video] = rows[i];

        let imgEmbed = "", videoEmbed = "";

        if (image && image.includes("http")) {
          imgEmbed = `<img src="${image}" style="max-width:100%;margin-top:10px;">`;
        }

        if (video) {
          if (video.includes("youtube.com") || video.includes("youtu.be")) {
            const ytID = video.split("v=")[1] || video.split("/").pop();
            videoEmbed = `<iframe width="100%" height="315" src="https://www.youtube.com/embed/${ytID}" frameborder="0" allowfullscreen></iframe>`;
          } else if (video.includes("drive.google.com")) {
            const fileId = video.match(/[-\\w]{25,}/);
            if (fileId) {
              videoEmbed = `<iframe src="https://drive.google.com/file/d/${fileId[0]}/preview" width="100%" height="315" allow="autoplay"></iframe>`;
            }
          }
        }

        const div = document.createElement("div");
        div.className = "page-box " + anim;
        div.style.color = color;
        div.style.backgroundColor = bgColor;
        div.style.fontFamily = font;

        div.innerHTML = `
          <h3>${title}</h3>
          <p>${desc}</p>
          ${imgEmbed}
          ${videoEmbed}
          <small>Posted: ${timestamp}</small>
        `;
        container.appendChild(div);
      }
    }

    loadPages();
  </script>
</body>
</html>
