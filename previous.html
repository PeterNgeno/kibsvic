<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Recent Projects ‚Äì KIBSVIC LIMITED</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
    padding: 0;
    color: #333;
  }
  header, footer {
    background-color: #2ecc71;
    color: white;
    padding: 15px 20px;
    text-align: center;
  }
  .container {
    padding: 20px;
    max-width: 1000px;
    margin: auto;
  }
  h1 { color: #2ecc71; }
  .project {
    background: white;
    border-radius: 10px;
    margin-bottom: 20px;
    padding: 15px;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
    position: relative;
  }
  .project img {
    width: 100%;
    border-radius: 8px;
    max-height: 300px;
    object-fit: cover;
    cursor: pointer;
  }
  .delete-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #e74c3c;
    color: white;
    border: none;
    padding: 5px 8px;
    border-radius: 5px;
    cursor: pointer;
  }
  .delete-btn:hover { background: #c0392b; }
  .add-btn, .save-btn {
    display: block;
    background: #27ae60;
    color: white;
    text-align: center;
    padding: 10px;
    border-radius: 8px;
    cursor: pointer;
    margin-top: 20px;
  }
  .add-btn:hover, .save-btn:hover { background: #219150; }
  .font-picker, .color-picker {
    margin: 5px 0;
  }
  .back {
    margin-top: 20px;
    display: inline-block;
    background: #2ecc71;
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    text-decoration: none;
  }
  .back:hover { background: #27ae60; }
</style>
</head>
<body>

<header>
  <h1 contenteditable="true">Recent Projects ‚Äì KIBSVIC LIMITED</h1>
</header>

<div class="container" id="projectContainer"></div>

<div class="container">
  <div class="add-btn" onclick="addProject()">+ Add New Project</div>
  <div class="save-btn" onclick="saveProjects()">üíæ Save Changes</div>
  <a class="back" href="index.html">‚Üê Back to Home</a>
</div>

<footer contenteditable="true">
  &copy; 2025 KIBSVIC LIMITED
</footer>

<script>
const CLOUD_NAME = "dexu7ajwh";
const UPLOAD_PRESET = "unsigned"; // Create an unsigned preset in Cloudinary dashboard

function addProject(title = "New Project", desc = "Project details go here...", imgUrl = "https://via.placeholder.com/600x300") {
  const container = document.getElementById("projectContainer");
  const div = document.createElement("div");
  div.className = "project";

  const delBtn = document.createElement("button");
  delBtn.className = "delete-btn";
  delBtn.innerText = "‚úñ";
  delBtn.onclick = () => { div.remove(); saveProjects(); };

  const img = document.createElement("img");
  img.src = imgUrl;
  img.onclick = () => uploadToCloudinary(img);

  const h2 = document.createElement("h2");
  h2.contentEditable = "true";
  h2.innerText = title;

  const titleColor = document.createElement("input");
  titleColor.type = "color";
  titleColor.className = "color-picker";
  titleColor.oninput = () => { h2.style.color = titleColor.value; saveProjects(); };

  const titleFont = document.createElement("select");
  titleFont.className = "font-picker";
  ["Arial", "Verdana", "Georgia", "Courier New", "Times New Roman"].forEach(f => {
    const opt = document.createElement("option");
    opt.value = f; opt.textContent = f;
    titleFont.appendChild(opt);
  });
  titleFont.onchange = () => { h2.style.fontFamily = titleFont.value; saveProjects(); };

  const p = document.createElement("p");
  p.contentEditable = "true";
  p.innerText = desc;

  const textColor = document.createElement("input");
  textColor.type = "color";
  textColor.className = "color-picker";
  textColor.oninput = () => { p.style.color = textColor.value; saveProjects(); };

  const textFont = document.createElement("select");
  textFont.className = "font-picker";
  ["Arial", "Verdana", "Georgia", "Courier New", "Times New Roman"].forEach(f => {
    const opt = document.createElement("option");
    opt.value = f; opt.textContent = f;
    textFont.appendChild(opt);
  });
  textFont.onchange = () => { p.style.fontFamily = textFont.value; saveProjects(); };

  div.append(delBtn, img, h2, titleColor, titleFont, p, textColor, textFont);
  container.appendChild(div);
}

async function uploadToCloudinary(imgElement) {
  const input = document.createElement("input");
  input.type = "file";
  input.accept = "image/*";
  input.onchange = async e => {
    const file = e.target.files[0];
    if (!file) return;
    const formData = new FormData();
    formData.append("file", file);
    formData.append("upload_preset", UPLOAD_PRESET);

    const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
      method: "POST",
      body: formData
    });
    const data = await res.json();
    imgElement.src = data.secure_url;
    saveProjects();
    alert("‚úÖ Image uploaded successfully!");
  };
  input.click();
}

function saveProjects() {
  const projects = [];
  document.querySelectorAll(".project").forEach(p => {
    projects.push({
      title: p.querySelector("h2").innerText,
      desc: p.querySelector("p").innerText,
      img: p.querySelector("img").src,
      titleColor: p.querySelectorAll(".color-picker")[0].value || "#2ecc71",
      titleFont: p.querySelectorAll(".font-picker")[0].value || "Arial",
      textColor: p.querySelectorAll(".color-picker")[1].value || "#333",
      textFont: p.querySelectorAll(".font-picker")[1].value || "Arial"
    });
  });
  localStorage.setItem("kibsvic_projects", JSON.stringify(projects));
  alert("üíæ All changes saved!");
}

function loadProjects() {
  const data = JSON.parse(localStorage.getItem("kibsvic_projects") || "[]");
  if (data.length > 0) {
    data.forEach(proj => {
      addProject(proj.title, proj.desc, proj.img);
      const project = document.querySelectorAll(".project")[document.querySelectorAll(".project").length - 1];
      project.querySelector("h2").style.color = proj.titleColor;
      project.querySelector("h2").style.fontFamily = proj.titleFont;
      project.querySelector("p").style.color = proj.textColor;
      project.querySelector("p").style.fontFamily = proj.textFont;
    });
  }
}

window.onload = loadProjects;
</script>
</body>
</html>
